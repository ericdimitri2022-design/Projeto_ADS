<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Aguarde um momento...</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  
  <div class="adblock-modal-overlay" id="adblock-modal">
      <div class="adblock-modal-content">
          <div class="icon">
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor"><path d="M15.936 2.5L21.5 8.064V15.936L15.936 21.5H8.064L2.5 15.936V8.064L8.064 2.5H15.936ZM15 17H9V19H15V17ZM15 5H9V15H15V5Z"></path></svg>
          </div>
          <h2>AdBlocker Detectado!</h2>
          <p>Para continuar e liberar seu link, por favor, desative seu bloqueador de anúncios e atualize a página.</p>
          <a class="adblock-refresh-button" onclick="location.reload()">Atualizar Página</a>
      </div>
  </div>

  <div class="banner-fixo" id="banner-fixo-ads">
    <script type="text/javascript">
      atOptions = { 'key' : '5aed398ecdebf38696b5a0131d685b5b', 'format' : 'iframe', 'height' : 50, 'width' : 320, 'params' : {} };
    </script>
    <script type="text/javascript" src="//www.highperformanceformat.com/5aed398ecdebf38696b5a0131d685b5b/invoke.js"></script>
  </div>

  <div class="card">
    <h1 id="titulo">Preparando seu link...</h1>
    <p id="subtexto">Enquanto isso, leia uma notícia:</p>
    <div id="circle" class="circle" style="--progress:0">15</div>
    <div id="area-conteudo" class="conteudo-card" style="display: none;">
        <h3 id="conteudo-titulo">Carregando notícia...</h3>
        <p id="conteudo-texto"></p>
        <small id="conteudo-fonte"></small>
    </div>
    <button id="botao" class="btn">CONTINUAR PARA O DOWNLOAD</button>
    <div class="banner-native">
      <script async="async" data-cfasync="false" src="//pl27806509.effectivegatecpm.com/fc9e45b5ad616584db5c86a8934458a0/invoke.js"></script>
      <div id="container-fc9e45b5ad616584db5c86a8934458a0"></div>
    </div>
    <footer>© 2025 EricDfpXproads. Todos os direitos reservados.</footer>
  </div>

  <script type='text/javascript' src='//pl27806574.effectivegatecpm.com/5c/d9/9e/5cd99e5c3ffff1cc40d62cb9be9886f7.js'></script>
  
  <script>
    document.addEventListener('DOMContentLoaded', () => {
        const bannerFixo = document.getElementById('banner-fixo-ads');
        
        // Lógica de Detecção Final e Robusta
        setTimeout(() => {
            const containerEscondido = bannerFixo.offsetHeight < 10;
            const containerVazio = !bannerFixo.querySelector('iframe') && !bannerFixo.querySelector('ins');

            if (containerEscondido || containerVazio) {
                console.log("AdBlocker DETECTADO!", {containerEscondido, containerVazio});
                document.getElementById('adblock-modal').style.display = 'flex';
            } else {
                console.log("AdBlocker não detectado.");
            }
        }, 1500);

        // O resto do código
        function carregarNoticiasDaAPI() {
            const apiKey = '76f6c27aa4214115aa6a9e9552c5e27f';
            const url = `https://newsapi.org/v2/top-headlines?country=br&pageSize=20&apiKey=${apiKey}`;
            fetch(url).then(response => response.json()).then(data => {
                if (data.status === "ok" && data.articles.length > 0) {
                    const noticia = data.articles[Math.floor(Math.random() * data.articles.length)];
                    document.getElementById('conteudo-titulo').textContent = noticia.title;
                    document.getElementById('conteudo-texto').textContent = noticia.description || "Clique para ler a matéria completa.";
                    document.getElementById('conteudo-fonte').textContent = `Fonte: ${noticia.source.name}`;
                    const areaConteudo = document.getElementById('area-conteudo');
                    areaConteudo.style.display = 'block';
                    areaConteudo.style.cursor = 'pointer';
                    areaConteudo.onclick = () => { window.open(noticia.url, '_blank'); };
                }
            }).catch(error => { console.error("Erro ao buscar notícias:", error); });
        }
        carregarNoticiasDaAPI();
        const circle = document.getElementById("circle");
        const botao = document.getElementById("botao");
        const titulo = document.getElementById("titulo");
        const subtexto = document.getElementById("subtexto");
        const urlParams = new URLSearchParams(window.location.search);
        const destino = urlParams.get('destino');
        let contador = 15;
        const intervalo = setInterval(() => {
          contador--;
          const progresso = (100 - (contador * (100 / 15)));
          circle.style.setProperty("--progress", progresso);
          circle.textContent = contador;
          if (contador <= 0) {
            clearInterval(intervalo);
            circle.style.display = "none";
            document.getElementById('area-conteudo').style.display = 'none';
            botao.classList.add("show");
            titulo.textContent = "Seu link está pronto!";
            subtexto.textContent = "Clique abaixo para continuar.";
          }
        }, 1000);
        botao.addEventListener("click", () => {
          if (destino) { window.location.href = `/bonus?destino=${encodeURIComponent(destino)}`; } 
          else { window.location.href = "/bonus"; }
        });
    });
  </script>
</body>
</html>
